{% extends "views/layout.html" %}

{% block title %}
{{title}}
{% endblock %} 


{% block head %}
<style>
	html { height: 100%; }
	body { height: 100%; margin: 0; padding: 0 }
	#map { width: 100%; height: 100%; }
	.box {font-weight: bold; padding:2px; border-radius:5px;}
	.info-content {background: rgba(255,255,255,0.8);}
	.red { background-color:red; color:white; }
	.yellow { background-color:yellow; color:black; }
	.green { background-color:green; color:white; }
</style>
{% endblock %}


{% block content %}
<div id='map'></div>
{% endblock %}


{% block scripts %}
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
<script type="text/javascript" src="http://apis.daum.net/maps/maps3.js?apikey=be8461f474875777838e40e92203110657225288"></script>
<script type="text/javascript" src="js/map.js"></script>
<script type="text/javascript">
var data = {{data}};
$(function(){
	var map = initMap();
	_.each(data, function(d){
		if (d.latitude.trim() != "") {
			var pos = new daum.maps.LatLng(d.latitude, d.longitude);
			var g = d.group;
			if (g.indexOf("사랑") > -1) {
				g = "<span class='box red'>" + g + "</span>";
			} else if (g.indexOf("소망") > -1) {
				g = "<span class='box yellow'>" + g + "</span>";
			} else if (g.indexOf("믿음") > -1) {
				g = "<span class='box green'>" + g + "</span>";
			}
			addMarker(map, pos, "<div class='box info-content'>" + g + d.name + "</div>");
		}
	});

	$(".info-content").parent().parent().addClass("info-window");
	$(".info-content").parent().siblings().remove();
	$(".info-content")
		.css("width","80px")
		.css("height","25px")
		.css("text-align", "center")
		.css("font-size", "6pt")
		.css("line-height", "25px");

	$(".info-window").each(function(){
		$(this).css("background","")
		.css("border","")
		.css("width","80px")
	});
});
</script>
{% endblock %}
